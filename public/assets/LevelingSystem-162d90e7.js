class r{constructor(){this.experience=0,this.level=1,this.availableUpgrades=[],this.selectedUpgrade=null,this.expTable=this.generateExpTable()}generateExpTable(){const e=[];let t=100;for(let i=1;i<=100;i++)e.push(t),t=Math.floor(t*1.4);return e}addExperience(e){return this.experience+=e,this.checkLevelUp()}checkLevelUp(){const e=this.getRequiredExpForLevel(this.level+1);return this.experience>=e&&this.level<100?(this.level++,this.generateUpgradeChoices(),!0):!1}getRequiredExpForLevel(e){return e<=1?0:this.expTable[e-2]||this.expTable[this.expTable.length-1]}getCurrentLevelProgress(){const e=this.getRequiredExpForLevel(this.level),t=this.getRequiredExpForLevel(this.level+1),i=this.experience-e,l=t-e;return{current:i,total:l,percentage:Math.min(1,i/l)}}generateUpgradeChoices(){const t=[...[{id:"damage",name:"攻撃力UP",description:"ダメージが25%増加",icon:"⚔️",effect:{type:"damage",value:.25}},{id:"fireRate",name:"攻撃速度UP",description:"射撃レートが20%向上",icon:"🔥",effect:{type:"fireRate",value:.2}},{id:"speed",name:"移動速度UP",description:"移動速度が15%向上",icon:"💨",effect:{type:"speed",value:.15}},{id:"health",name:"体力UP",description:"最大HPが1増加",icon:"❤️",effect:{type:"health",value:1}},{id:"multiShot",name:"弾数増加",description:"同時発射弾数が1増加",icon:"🔫",effect:{type:"multiShot",value:1}},{id:"piercing",name:"貫通力",description:"弾が敵を貫通する",icon:"🎯",effect:{type:"piercing",value:1}},{id:"explosive",name:"範囲攻撃",description:"爆発範囲ダメージ",icon:"💥",effect:{type:"explosive",value:1}},{id:"lifesteal",name:"ライフスティール",description:"敵撃破時HP回復",icon:"🩸",effect:{type:"lifesteal",value:1}}]].sort(()=>Math.random()-.5);this.availableUpgrades=t.slice(0,3)}selectUpgrade(e){return e>=0&&e<this.availableUpgrades.length?(this.selectedUpgrade=this.availableUpgrades[e],this.availableUpgrades=[],this.selectedUpgrade):null}getLevel(){return this.level}getExperience(){return this.experience}getAvailableUpgrades(){return this.availableUpgrades}hasAvailableUpgrades(){return this.availableUpgrades.length>0}reset(){this.experience=0,this.level=1,this.availableUpgrades=[],this.selectedUpgrade=null}getSaveData(){return{maxLevel:this.level}}}export{r as LevelingSystem};
