import{Bullet as h,SpreadBullet as g,PowerBullet as f,LaserBullet as w}from"./Bullet-7b575848.js";import"./Entity-ae023216.js";class R{constructor(){this.weapons={normal:{name:"Normal",fireRate:8,damage:1,speed:500,spread:0,bulletCount:1,bulletClass:h},spread:{name:"Spread",fireRate:6,damage:.75,speed:400,spread:.3,bulletCount:5,bulletClass:g},power:{name:"Power",fireRate:3,damage:3,speed:350,spread:0,bulletCount:1,bulletClass:f},rapid:{name:"Rapid",fireRate:15,damage:.5,speed:600,spread:.1,bulletCount:1,bulletClass:h},laser:{name:"Laser",fireRate:20,damage:.5,speed:800,spread:0,bulletCount:1,bulletClass:w}},this.currentWeapon="normal",this.weaponDuration=10,this.weaponTimer=0,this.defaultWeapon="normal"}reset(){this.currentWeapon=this.defaultWeapon,this.weaponTimer=0}update(e){this.currentWeapon!==this.defaultWeapon&&this.weaponTimer>0&&(this.weaponTimer-=e,this.weaponTimer<=0&&(this.currentWeapon=this.defaultWeapon))}setWeapon(e,s=null){this.weapons[e]&&(this.currentWeapon=e,s!==null?this.weaponTimer=s:this.weaponTimer=this.weaponDuration)}fire(e,s,a,n=null){const t=this.weapons[this.currentWeapon],o=[];let r=[a];return n&&(r=n.getMultiShotAngles(a)),r.forEach(p=>{if(t.bulletCount===1){const l=new t.bulletClass(e,s,p+(Math.random()-.5)*t.spread,t.speed,t.damage);n&&this.applyPermanentUpgradesToBullet(l,n),o.push(l)}else{const l=t.spread,m=l/(t.bulletCount-1),d=p-l/2;for(let i=0;i<t.bulletCount;i++){const c=d+m*i,u=new t.bulletClass(e,s,c,t.speed,t.damage);n&&this.applyPermanentUpgradesToBullet(u,n),o.push(u)}}}),o}applyPermanentUpgradesToBullet(e,s){const a=s.getBulletStats(e);e.damage=a.damage,a.piercing&&(e.piercing=!0,e.piercingCount=a.piercingCount||1),a.explosive&&(e.explosive=!0,e.explosionRadius=a.explosionRadius,e.explosionDamage=a.explosionDamage)}getFireRate(){return this.weapons[this.currentWeapon].fireRate}getCurrentWeapon(){return this.weapons[this.currentWeapon]}getWeaponTimeRemaining(){return Math.max(0,this.weaponTimer)}getWeaponList(){return Object.keys(this.weapons)}}export{R as WeaponSystem};
